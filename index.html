<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <link href="style.css" rel="stylesheet">
        <title>Luntask</title>
    </head>
    <body>
        <div class="game">
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
            <div class="cubs"></div>
             <div class="cubs"></div>
        </div>
        <div id="reset" onclick="fillgame()">shuffle</div>
        <script>
            function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min)) + min;
}
            function mixarr()
            {
                ars = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16];
                var count = 16;
                for(var i = 0;i<4;i++)
                {
                    for(var j=0;j<4;j++)
                    {
                        
                        arr[i][j]=0;
                        s = getRandomInt(0,count);
                        
                        
                        arr[i][j]=ars[s];
                        
                        for(var k=s;k<count-1;k++)
                        {
                            ars[k] = ars[k+1];
                        }
                        count--;
                    }
                        
                }
            }
                
            
            var arr= new Array();
            var digit =1;
                for(var i = 0;i<4;i++)
                {
                    arr[i]=new Array();
                
                    for(var j=0;j<4;j++)
                    {
                        arr[i][j]=digit;
                        digit++;
                    }
                }
                
             
            var cub = document.body.getElementsByClassName("cubs");
            
            function fillgame()//заполнить блоки цифрами
            {
             
                mixarr();
                fillblock();
             
            }
            function fillblock(){
            var numb=0;
             for(var i = 0;i<4;i++)
             {
                
                for(var j=0;j<4;j++)
                    {   
                       cub[numb].innerHTML=arr[i][j];
                        cub[numb].style.backgroundColor="white";
                        if (arr[i][j]==16)
                        {
                            cub[numb].style.backgroundColor="orange";
                            cub[numb].innerHTML='';
                        }
                        numb++;
                        
                    }
                }
                
            }
            function getcordinate(){
                var x = 0;
                var y = 0;
                var bo_l=true;
                for(x;x<4;x++)
                    {
                      
                        for(var j=0;j<4;j++)
                            {
                                if(arr[x][j]==16)
                                    {
                                        y=j;
                                        bo_l=false;
                                        
                                        break;
                                    }
                                    
                            }
                          if(bo_l==false)
                            {
                                break;
                            }
                        
                    }
                var z=[x,y];
                
                return z;
            }
            function moveleft(){
                 
               var cord=getcordinate();
                var i=cord[0];
                var j= cord[1];
                if(j!=3)
                    {
                        var temp = arr[i][j+1];
                    arr[i][j+1]=16;
                    arr[i][j]=temp;
                    fillblock();
                    }
            }
            function moveright(){
                var cord=getcordinate();
                var i=cord[0];
                var j= cord[1];
                if(j!=0)
                    {
                        var temp = arr[i][j-1];
                    arr[i][j-1]=16;
                    arr[i][j]=temp;
                    fillblock();
                    }
            }
            function moveup(){
                 var cord=getcordinate();
                var i=cord[0];
                var j= cord[1];
                if(i!=3)
                    {
                        var temp = arr[i+1][j];
                    arr[i+1][j]=16;
                    arr[i][j]=temp;
                    fillblock();
                    }
            }
            function movedown(){
                var cord=getcordinate();
                var i=cord[0];
                var j= cord[1];
                if(i!=0)
                    {
                        var temp = arr[i-1][j];
                    arr[i-1][j]=16;
                    arr[i][j]=temp;
                    fillblock();
                    }
            }
            function checkwin()
            {
                if(arr[0][0]==1&& arr[3][3]==16)
                    {
                         
                        var bol_=true;
                        var prevv=0;
                        
                        for(var i = 0;i<4;i++)
                        {
                                 
                        for(var j=0;j<4;j++)
                            {
                                
                               if(arr[i][j]==prevv+1){
                                   prevv=arr[i][j];
                                   continue;
                               }
                                else{
                                    bol_=false;
                                   
                                    break;
                                }

                            }
                        }
                        if(bol_==true)
                            {
                                alert("Well done!");
                                return true;
                                
                            }
                        else//можно было не писать
                        {
                            return false;
                        }
                    }
            }
            
            fillblock();
            
            
            document.addEventListener("keydown",moveRect);
            function moveRect(e){
              
            switch(e.keyCode){
            
            case 37:
                
                moveleft();
                    checkwin();
                break;
            case 38:  
                moveup()
                    checkwin();
                break;
            case 39: 
                moveright();
                    checkwin();
                break;
            case 40:   
                movedown()
                    checkwin();
                break;
            
                }
                }
            
           
            
        </script>
    </body>
</html>